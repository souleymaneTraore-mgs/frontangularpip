/**
 * @fileoverview added by tsickle
 * Generated from: lib/components/notifier-container.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ChangeDetectionStrategy, ChangeDetectorRef, Component } from '@angular/core';
import { NotifierNotification } from '../models/notifier-notification.model';
import { NotifierService } from '../services/notifier.service';
import { NotifierQueueService } from '../services/notifier-queue.service';
/**
 * Notifier container component
 * ----------------------------
 * This component acts as a wrapper for all notification components; consequently, it is responsible for creating a new notification
 * component and removing an existing notification component. Being more precicely, it also handles side effects of those actions, such as
 * shifting or even completely removing other notifications as well. Overall, this components handles actions coming from the queue service
 * by subscribing to its action stream.
 *
 * Technical sidenote:
 * This component has to be used somewhere in an application to work; it will not inject and create itself automatically, primarily in order
 * to not break the Angular AoT compilation. Moreover, this component (and also the notification components) set their change detection
 * strategy onPush, which means that we handle change detection manually in order to get the best performance. (#perfmatters)
 */
var NotifierContainerComponent = /** @class */ (function () {
    /**
     * Constructor
     *
     * @param changeDetector       Change detector, used for manually triggering change detection runs
     * @param notifierQueueService Notifier queue service
     * @param notifierService      Notifier service
     */
    function NotifierContainerComponent(changeDetector, notifierQueueService, notifierService) {
        var _this = this;
        this.changeDetector = changeDetector;
        this.queueService = notifierQueueService;
        this.config = notifierService.getConfig();
        this.notifications = [];
        // Connects this component up to the action queue, then handle incoming actions
        this.queueServiceSubscription = this.queueService.actionStream.subscribe((/**
         * @param {?} action
         * @return {?}
         */
        function (action) {
            _this.handleAction(action).then((/**
             * @return {?}
             */
            function () {
                _this.queueService.continue();
            }));
        }));
    }
    /**
     * Component destroyment lifecycle hook, cleans up the observable subsciption
     */
    /**
     * Component destroyment lifecycle hook, cleans up the observable subsciption
     * @return {?}
     */
    NotifierContainerComponent.prototype.ngOnDestroy = /**
     * Component destroyment lifecycle hook, cleans up the observable subsciption
     * @return {?}
     */
    function () {
        if (this.queueServiceSubscription) {
            this.queueServiceSubscription.unsubscribe();
        }
    };
    /**
     * Notification identifier, used as the ngFor trackby function
     *
     * @param   index        Index
     * @param   notification Notifier notification
     * @returns Notification ID as the unique identnfier
     */
    /**
     * Notification identifier, used as the ngFor trackby function
     *
     * @param {?} index        Index
     * @param {?} notification Notifier notification
     * @return {?} Notification ID as the unique identnfier
     */
    NotifierContainerComponent.prototype.identifyNotification = /**
     * Notification identifier, used as the ngFor trackby function
     *
     * @param {?} index        Index
     * @param {?} notification Notifier notification
     * @return {?} Notification ID as the unique identnfier
     */
    function (index, notification) {
        return notification.id;
    };
    /**
     * Event handler, handles clicks on notification dismiss buttons
     *
     * @param notificationId ID of the notification to dismiss
     */
    /**
     * Event handler, handles clicks on notification dismiss buttons
     *
     * @param {?} notificationId ID of the notification to dismiss
     * @return {?}
     */
    NotifierContainerComponent.prototype.onNotificationDismiss = /**
     * Event handler, handles clicks on notification dismiss buttons
     *
     * @param {?} notificationId ID of the notification to dismiss
     * @return {?}
     */
    function (notificationId) {
        this.queueService.push({
            payload: notificationId,
            type: 'HIDE',
        });
    };
    /**
     * Event handler, handles notification ready events
     *
     * @param notificationComponent Notification component reference
     */
    /**
     * Event handler, handles notification ready events
     *
     * @param {?} notificationComponent Notification component reference
     * @return {?}
     */
    NotifierContainerComponent.prototype.onNotificationReady = /**
     * Event handler, handles notification ready events
     *
     * @param {?} notificationComponent Notification component reference
     * @return {?}
     */
    function (notificationComponent) {
        /** @type {?} */
        var currentNotification = this.notifications[this.notifications.length - 1];
        currentNotification.component = notificationComponent; // Save the new omponent reference
        this.continueHandleShowAction(currentNotification); // Continue with handling the show action
    };
    /**
     * Handle incoming actions by mapping action types to methods, and then running them
     *
     * @param   action Action object
     * @returns Promise, resolved when done
     */
    /**
     * Handle incoming actions by mapping action types to methods, and then running them
     *
     * @private
     * @param {?} action Action object
     * @return {?} Promise, resolved when done
     */
    NotifierContainerComponent.prototype.handleAction = /**
     * Handle incoming actions by mapping action types to methods, and then running them
     *
     * @private
     * @param {?} action Action object
     * @return {?} Promise, resolved when done
     */
    function (action) {
        switch (action.type // TODO: Maybe a map (actionType -> class method) is a cleaner solution here?
        ) {
            case 'SHOW':
                return this.handleShowAction(action);
            case 'HIDE':
                return this.handleHideAction(action);
            case 'HIDE_OLDEST':
                return this.handleHideOldestAction(action);
            case 'HIDE_NEWEST':
                return this.handleHideNewestAction(action);
            case 'HIDE_ALL':
                return this.handleHideAllAction();
            default:
                return new Promise((/**
                 * @param {?} resolve
                 * @return {?}
                 */
                function (resolve) {
                    resolve(); // Ignore unknown action types
                }));
        }
    };
    /**
     * Show a new notification
     *
     * We simply add the notification to the list, and then wait until its properly initialized / created / rendered.
     *
     * @param   action Action object
     * @returns Promise, resolved when done
     */
    /**
     * Show a new notification
     *
     * We simply add the notification to the list, and then wait until its properly initialized / created / rendered.
     *
     * @private
     * @param {?} action Action object
     * @return {?} Promise, resolved when done
     */
    NotifierContainerComponent.prototype.handleShowAction = /**
     * Show a new notification
     *
     * We simply add the notification to the list, and then wait until its properly initialized / created / rendered.
     *
     * @private
     * @param {?} action Action object
     * @return {?} Promise, resolved when done
     */
    function (action) {
        var _this = this;
        return new Promise((/**
         * @param {?} resolve
         * @return {?}
         */
        function (resolve) {
            _this.tempPromiseResolver = resolve; // Save the promise resolve function so that it can be called later on by another method
            _this.addNotificationToList(new NotifierNotification(action.payload));
        }));
    };
    /**
     * Continue to show a new notification (after the notification components is initialized / created / rendered).
     *
     * If this is the first (and thus only) notification, we can simply show it. Otherwhise, if stacking is disabled (or a low value), we
     * switch out notifications, in particular we hide the existing one, and then show our new one. Yet, if stacking is enabled, we first
     * shift all older notifications, and then show our new notification. In addition, if there are too many notification on the screen,
     * we hide the oldest one first. Furthermore, if configured, animation overlapping is applied.
     *
     * @param notification New notification to show
     */
    /**
     * Continue to show a new notification (after the notification components is initialized / created / rendered).
     *
     * If this is the first (and thus only) notification, we can simply show it. Otherwhise, if stacking is disabled (or a low value), we
     * switch out notifications, in particular we hide the existing one, and then show our new one. Yet, if stacking is enabled, we first
     * shift all older notifications, and then show our new notification. In addition, if there are too many notification on the screen,
     * we hide the oldest one first. Furthermore, if configured, animation overlapping is applied.
     *
     * @private
     * @param {?} notification New notification to show
     * @return {?}
     */
    NotifierContainerComponent.prototype.continueHandleShowAction = /**
     * Continue to show a new notification (after the notification components is initialized / created / rendered).
     *
     * If this is the first (and thus only) notification, we can simply show it. Otherwhise, if stacking is disabled (or a low value), we
     * switch out notifications, in particular we hide the existing one, and then show our new one. Yet, if stacking is enabled, we first
     * shift all older notifications, and then show our new notification. In addition, if there are too many notification on the screen,
     * we hide the oldest one first. Furthermore, if configured, animation overlapping is applied.
     *
     * @private
     * @param {?} notification New notification to show
     * @return {?}
     */
    function (notification) {
        var _this = this;
        // First (which means only one) notification in the list?
        /** @type {?} */
        var numberOfNotifications = this.notifications.length;
        if (numberOfNotifications === 1) {
            notification.component.show().then(this.tempPromiseResolver); // Done
        }
        else {
            /** @type {?} */
            var implicitStackingLimit = 2;
            // Stacking enabled? (stacking value below 2 means stacking is disabled)
            if (this.config.behaviour.stacking === false || this.config.behaviour.stacking < implicitStackingLimit) {
                this.notifications[0].component.hide().then((/**
                 * @return {?}
                 */
                function () {
                    _this.removeNotificationFromList(_this.notifications[0]);
                    notification.component.show().then(_this.tempPromiseResolver); // Done
                }));
            }
            else {
                /** @type {?} */
                var stepPromises_1 = [];
                // Are there now too many notifications?
                if (numberOfNotifications > this.config.behaviour.stacking) {
                    /** @type {?} */
                    var oldNotifications_1 = this.notifications.slice(1, numberOfNotifications - 1);
                    // Are animations enabled?
                    if (this.config.animations.enabled) {
                        // Is animation overlap enabled?
                        if (this.config.animations.overlap !== false && this.config.animations.overlap > 0) {
                            stepPromises_1.push(this.notifications[0].component.hide());
                            setTimeout((/**
                             * @return {?}
                             */
                            function () {
                                stepPromises_1.push(_this.shiftNotifications(oldNotifications_1, notification.component.getHeight(), true));
                            }), this.config.animations.hide.speed - this.config.animations.overlap);
                            setTimeout((/**
                             * @return {?}
                             */
                            function () {
                                stepPromises_1.push(notification.component.show());
                            }), this.config.animations.hide.speed + this.config.animations.shift.speed - this.config.animations.overlap);
                        }
                        else {
                            stepPromises_1.push(new Promise((/**
                             * @param {?} resolve
                             * @return {?}
                             */
                            function (resolve) {
                                _this.notifications[0].component.hide().then((/**
                                 * @return {?}
                                 */
                                function () {
                                    _this.shiftNotifications(oldNotifications_1, notification.component.getHeight(), true).then((/**
                                     * @return {?}
                                     */
                                    function () {
                                        notification.component.show().then(resolve);
                                    }));
                                }));
                            })));
                        }
                    }
                    else {
                        stepPromises_1.push(this.notifications[0].component.hide());
                        stepPromises_1.push(this.shiftNotifications(oldNotifications_1, notification.component.getHeight(), true));
                        stepPromises_1.push(notification.component.show());
                    }
                }
                else {
                    /** @type {?} */
                    var oldNotifications_2 = this.notifications.slice(0, numberOfNotifications - 1);
                    // Are animations enabled?
                    if (this.config.animations.enabled) {
                        // Is animation overlap enabled?
                        if (this.config.animations.overlap !== false && this.config.animations.overlap > 0) {
                            stepPromises_1.push(this.shiftNotifications(oldNotifications_2, notification.component.getHeight(), true));
                            setTimeout((/**
                             * @return {?}
                             */
                            function () {
                                stepPromises_1.push(notification.component.show());
                            }), this.config.animations.shift.speed - this.config.animations.overlap);
                        }
                        else {
                            stepPromises_1.push(new Promise((/**
                             * @param {?} resolve
                             * @return {?}
                             */
                            function (resolve) {
                                _this.shiftNotifications(oldNotifications_2, notification.component.getHeight(), true).then((/**
                                 * @return {?}
                                 */
                                function () {
                                    notification.component.show().then(resolve);
                                }));
                            })));
                        }
                    }
                    else {
                        stepPromises_1.push(this.shiftNotifications(oldNotifications_2, notification.component.getHeight(), true));
                        stepPromises_1.push(notification.component.show());
                    }
                }
                Promise.all(stepPromises_1).then((/**
                 * @return {?}
                 */
                function () {
                    if (numberOfNotifications > _this.config.behaviour.stacking) {
                        _this.removeNotificationFromList(_this.notifications[0]);
                    }
                    _this.tempPromiseResolver();
                })); // Done
            }
        }
    };
    /**
     * Hide an existing notification
     *
     * Fist, we skip everything if there are no notifications at all, or the given notification does not exist. Then, we hide the given
     * notification. If there exist older notifications, we then shift them around to fill the gap. Once both hiding the given notification
     * and shifting the older notificaitons is done, the given notification gets finally removed (from the DOM).
     *
     * @param   action Action object, payload contains the notification ID
     * @returns Promise, resolved when done
     */
    /**
     * Hide an existing notification
     *
     * Fist, we skip everything if there are no notifications at all, or the given notification does not exist. Then, we hide the given
     * notification. If there exist older notifications, we then shift them around to fill the gap. Once both hiding the given notification
     * and shifting the older notificaitons is done, the given notification gets finally removed (from the DOM).
     *
     * @private
     * @param {?} action Action object, payload contains the notification ID
     * @return {?} Promise, resolved when done
     */
    NotifierContainerComponent.prototype.handleHideAction = /**
     * Hide an existing notification
     *
     * Fist, we skip everything if there are no notifications at all, or the given notification does not exist. Then, we hide the given
     * notification. If there exist older notifications, we then shift them around to fill the gap. Once both hiding the given notification
     * and shifting the older notificaitons is done, the given notification gets finally removed (from the DOM).
     *
     * @private
     * @param {?} action Action object, payload contains the notification ID
     * @return {?} Promise, resolved when done
     */
    function (action) {
        var _this = this;
        return new Promise((/**
         * @param {?} resolve
         * @return {?}
         */
        function (resolve) {
            /** @type {?} */
            var stepPromises = [];
            // Does the notification exist / are there even any notifications? (let's prevent accidential errors)
            /** @type {?} */
            var notification = _this.findNotificationById(action.payload);
            if (notification === undefined) {
                resolve();
                return;
            }
            // Get older notifications
            /** @type {?} */
            var notificationIndex = _this.findNotificationIndexById(action.payload);
            if (notificationIndex === undefined) {
                resolve();
                return;
            }
            /** @type {?} */
            var oldNotifications = _this.notifications.slice(0, notificationIndex);
            // Do older notifications exist, and thus do we need to shift other notifications as a consequence?
            if (oldNotifications.length > 0) {
                // Are animations enabled?
                if (_this.config.animations.enabled && _this.config.animations.hide.speed > 0) {
                    // Is animation overlap enabled?
                    if (_this.config.animations.overlap !== false && _this.config.animations.overlap > 0) {
                        stepPromises.push(notification.component.hide());
                        setTimeout((/**
                         * @return {?}
                         */
                        function () {
                            stepPromises.push(_this.shiftNotifications(oldNotifications, notification.component.getHeight(), false));
                        }), _this.config.animations.hide.speed - _this.config.animations.overlap);
                    }
                    else {
                        notification.component.hide().then((/**
                         * @return {?}
                         */
                        function () {
                            stepPromises.push(_this.shiftNotifications(oldNotifications, notification.component.getHeight(), false));
                        }));
                    }
                }
                else {
                    stepPromises.push(notification.component.hide());
                    stepPromises.push(_this.shiftNotifications(oldNotifications, notification.component.getHeight(), false));
                }
            }
            else {
                stepPromises.push(notification.component.hide());
            }
            // Wait until both hiding and shifting is done, then remove the notification from the list
            Promise.all(stepPromises).then((/**
             * @return {?}
             */
            function () {
                _this.removeNotificationFromList(notification);
                resolve(); // Done
            }));
        }));
    };
    /**
     * Hide the oldest notification (bridge to handleHideAction)
     *
     * @param   action Action object
     * @returns Promise, resolved when done
     */
    /**
     * Hide the oldest notification (bridge to handleHideAction)
     *
     * @private
     * @param {?} action Action object
     * @return {?} Promise, resolved when done
     */
    NotifierContainerComponent.prototype.handleHideOldestAction = /**
     * Hide the oldest notification (bridge to handleHideAction)
     *
     * @private
     * @param {?} action Action object
     * @return {?} Promise, resolved when done
     */
    function (action) {
        // Are there any notifications? (prevent accidential errors)
        if (this.notifications.length === 0) {
            return new Promise((/**
             * @param {?} resolve
             * @return {?}
             */
            function (resolve) {
                resolve();
            })); // Done
        }
        else {
            action.payload = this.notifications[0].id;
            return this.handleHideAction(action);
        }
    };
    /**
     * Hide the newest notification (bridge to handleHideAction)
     *
     * @param   action Action object
     * @returns Promise, resolved when done
     */
    /**
     * Hide the newest notification (bridge to handleHideAction)
     *
     * @private
     * @param {?} action Action object
     * @return {?} Promise, resolved when done
     */
    NotifierContainerComponent.prototype.handleHideNewestAction = /**
     * Hide the newest notification (bridge to handleHideAction)
     *
     * @private
     * @param {?} action Action object
     * @return {?} Promise, resolved when done
     */
    function (action) {
        // Are there any notifications? (prevent accidential errors)
        if (this.notifications.length === 0) {
            return new Promise((/**
             * @param {?} resolve
             * @return {?}
             */
            function (resolve) {
                resolve();
            })); // Done
        }
        else {
            action.payload = this.notifications[this.notifications.length - 1].id;
            return this.handleHideAction(action);
        }
    };
    /**
     * Hide all notifications at once
     *
     * @returns Promise, resolved when done
     */
    /**
     * Hide all notifications at once
     *
     * @private
     * @return {?} Promise, resolved when done
     */
    NotifierContainerComponent.prototype.handleHideAllAction = /**
     * Hide all notifications at once
     *
     * @private
     * @return {?} Promise, resolved when done
     */
    function () {
        var _this = this;
        return new Promise((/**
         * @param {?} resolve
         * @return {?}
         */
        function (resolve) {
            // Are there any notifications? (prevent accidential errors)
            /** @type {?} */
            var numberOfNotifications = _this.notifications.length;
            if (numberOfNotifications === 0) {
                resolve(); // Done
                return;
            }
            // Are animations enabled?
            if (_this.config.animations.enabled &&
                _this.config.animations.hide.speed > 0 &&
                _this.config.animations.hide.offset !== false &&
                _this.config.animations.hide.offset > 0) {
                var _loop_1 = function (i) {
                    /** @type {?} */
                    var animationOffset = _this.config.position.vertical.position === 'top' ? numberOfNotifications - 1 : i;
                    setTimeout((/**
                     * @return {?}
                     */
                    function () {
                        _this.notifications[i].component.hide().then((/**
                         * @return {?}
                         */
                        function () {
                            // Are we done here, was this the last notification to be hidden?
                            if ((_this.config.position.vertical.position === 'top' && i === 0) ||
                                (_this.config.position.vertical.position === 'bottom' && i === numberOfNotifications - 1)) {
                                _this.removeAllNotificationsFromList();
                                resolve(); // Done
                            }
                        }));
                    }), _this.config.animations.hide.offset * animationOffset);
                };
                for (var i = numberOfNotifications - 1; i >= 0; i--) {
                    _loop_1(i);
                }
            }
            else {
                /** @type {?} */
                var stepPromises = [];
                for (var i = numberOfNotifications - 1; i >= 0; i--) {
                    stepPromises.push(_this.notifications[i].component.hide());
                }
                Promise.all(stepPromises).then((/**
                 * @return {?}
                 */
                function () {
                    _this.removeAllNotificationsFromList();
                    resolve(); // Done
                }));
            }
        }));
    };
    /**
     * Shift multiple notifications at once
     *
     * @param   notifications List containing the notifications to be shifted
     * @param   distance      Distance to shift (in px)
     * @param   toMakePlace   Flag, defining in which direciton to shift
     * @returns Promise, resolved when done
     */
    /**
     * Shift multiple notifications at once
     *
     * @private
     * @param {?} notifications List containing the notifications to be shifted
     * @param {?} distance      Distance to shift (in px)
     * @param {?} toMakePlace   Flag, defining in which direciton to shift
     * @return {?} Promise, resolved when done
     */
    NotifierContainerComponent.prototype.shiftNotifications = /**
     * Shift multiple notifications at once
     *
     * @private
     * @param {?} notifications List containing the notifications to be shifted
     * @param {?} distance      Distance to shift (in px)
     * @param {?} toMakePlace   Flag, defining in which direciton to shift
     * @return {?} Promise, resolved when done
     */
    function (notifications, distance, toMakePlace) {
        return new Promise((/**
         * @param {?} resolve
         * @return {?}
         */
        function (resolve) {
            // Are there any notifications to shift?
            if (notifications.length === 0) {
                resolve();
                return;
            }
            /** @type {?} */
            var notificationPromises = [];
            for (var i = notifications.length - 1; i >= 0; i--) {
                notificationPromises.push(notifications[i].component.shift(distance, toMakePlace));
            }
            Promise.all(notificationPromises).then(resolve); // Done
        }));
    };
    /**
     * Add a new notification to the list of notifications (triggers change detection)
     *
     * @param notification Notification to add to the list of notifications
     */
    /**
     * Add a new notification to the list of notifications (triggers change detection)
     *
     * @private
     * @param {?} notification Notification to add to the list of notifications
     * @return {?}
     */
    NotifierContainerComponent.prototype.addNotificationToList = /**
     * Add a new notification to the list of notifications (triggers change detection)
     *
     * @private
     * @param {?} notification Notification to add to the list of notifications
     * @return {?}
     */
    function (notification) {
        this.notifications.push(notification);
        this.changeDetector.markForCheck(); // Run change detection because the notification list changed
    };
    /**
     * Remove an existing notification from the list of notifications (triggers change detection)
     *
     * @param notification Notification to be removed from the list of notifications
     */
    /**
     * Remove an existing notification from the list of notifications (triggers change detection)
     *
     * @private
     * @param {?} notification Notification to be removed from the list of notifications
     * @return {?}
     */
    NotifierContainerComponent.prototype.removeNotificationFromList = /**
     * Remove an existing notification from the list of notifications (triggers change detection)
     *
     * @private
     * @param {?} notification Notification to be removed from the list of notifications
     * @return {?}
     */
    function (notification) {
        this.notifications = this.notifications.filter((/**
         * @param {?} item
         * @return {?}
         */
        function (item) { return item.component !== notification.component; }));
        this.changeDetector.markForCheck(); // Run change detection because the notification list changed
    };
    /**
     * Remove all notifications from the list (triggers change detection)
     */
    /**
     * Remove all notifications from the list (triggers change detection)
     * @private
     * @return {?}
     */
    NotifierContainerComponent.prototype.removeAllNotificationsFromList = /**
     * Remove all notifications from the list (triggers change detection)
     * @private
     * @return {?}
     */
    function () {
        this.notifications = [];
        this.changeDetector.markForCheck(); // Run change detection because the notification list changed
    };
    /**
     * Helper: Find a notification in the notification list by a given notification ID
     *
     * @param   notificationId Notification ID, used for finding notification
     * @returns Notification, undefined if not found
     */
    /**
     * Helper: Find a notification in the notification list by a given notification ID
     *
     * @private
     * @param {?} notificationId Notification ID, used for finding notification
     * @return {?} Notification, undefined if not found
     */
    NotifierContainerComponent.prototype.findNotificationById = /**
     * Helper: Find a notification in the notification list by a given notification ID
     *
     * @private
     * @param {?} notificationId Notification ID, used for finding notification
     * @return {?} Notification, undefined if not found
     */
    function (notificationId) {
        return this.notifications.find((/**
         * @param {?} currentNotification
         * @return {?}
         */
        function (currentNotification) { return currentNotification.id === notificationId; }));
    };
    /**
     * Helper: Find a notification's index by a given notification ID
     *
     * @param   notificationId Notification ID, used for finding a notification's index
     * @returns Notification index, undefined if not found
     */
    /**
     * Helper: Find a notification's index by a given notification ID
     *
     * @private
     * @param {?} notificationId Notification ID, used for finding a notification's index
     * @return {?} Notification index, undefined if not found
     */
    NotifierContainerComponent.prototype.findNotificationIndexById = /**
     * Helper: Find a notification's index by a given notification ID
     *
     * @private
     * @param {?} notificationId Notification ID, used for finding a notification's index
     * @return {?} Notification index, undefined if not found
     */
    function (notificationId) {
        /** @type {?} */
        var notificationIndex = this.notifications.findIndex((/**
         * @param {?} currentNotification
         * @return {?}
         */
        function (currentNotification) { return currentNotification.id === notificationId; }));
        return notificationIndex !== -1 ? notificationIndex : undefined;
    };
    NotifierContainerComponent.decorators = [
        { type: Component, args: [{
                    changeDetection: ChangeDetectionStrategy.OnPush,
                    // (#perfmatters)
                    host: {
                        class: 'notifier__container',
                    },
                    selector: 'notifier-container',
                    template: "<ul>\n  <li class=\"notifier__container-list\" *ngFor=\"let notification of notifications; trackBy: identifyNotification\">\n    <notifier-notification [notification]=\"notification\" (ready)=\"onNotificationReady($event)\" (dismiss)=\"onNotificationDismiss($event)\">\n    </notifier-notification>\n  </li>\n</ul>\n"
                }] }
    ];
    /** @nocollapse */
    NotifierContainerComponent.ctorParameters = function () { return [
        { type: ChangeDetectorRef },
        { type: NotifierQueueService },
        { type: NotifierService }
    ]; };
    return NotifierContainerComponent;
}());
export { NotifierContainerComponent };
if (false) {
    /**
     * List of currently somewhat active notifications
     * @type {?}
     */
    NotifierContainerComponent.prototype.notifications;
    /**
     * Change detector
     * @type {?}
     * @private
     */
    NotifierContainerComponent.prototype.changeDetector;
    /**
     * Notifier queue service
     * @type {?}
     * @private
     */
    NotifierContainerComponent.prototype.queueService;
    /**
     * Notifier configuration
     * @type {?}
     * @private
     */
    NotifierContainerComponent.prototype.config;
    /**
     * Queue service observable subscription (saved for cleanup)
     * @type {?}
     * @private
     */
    NotifierContainerComponent.prototype.queueServiceSubscription;
    /**
     * Promise resolve function reference, temporarily used while the notification child component gets created
     * @type {?}
     * @private
     */
    NotifierContainerComponent.prototype.tempPromiseResolver;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibm90aWZpZXItY29udGFpbmVyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL2FuZ3VsYXItbm90aWZpZXIvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy9ub3RpZmllci1jb250YWluZXIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLHVCQUF1QixFQUFFLGlCQUFpQixFQUFFLFNBQVMsRUFBYSxNQUFNLGVBQWUsQ0FBQztBQUtqRyxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSx1Q0FBdUMsQ0FBQztBQUM3RSxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sOEJBQThCLENBQUM7QUFDL0QsT0FBTyxFQUFFLG9CQUFvQixFQUFFLE1BQU0sb0NBQW9DLENBQUM7Ozs7Ozs7Ozs7Ozs7O0FBZ0IxRTtJQXVDRTs7Ozs7O09BTUc7SUFDSCxvQ0FBbUIsY0FBaUMsRUFBRSxvQkFBMEMsRUFBRSxlQUFnQztRQUFsSSxpQkFZQztRQVhDLElBQUksQ0FBQyxjQUFjLEdBQUcsY0FBYyxDQUFDO1FBQ3JDLElBQUksQ0FBQyxZQUFZLEdBQUcsb0JBQW9CLENBQUM7UUFDekMsSUFBSSxDQUFDLE1BQU0sR0FBRyxlQUFlLENBQUMsU0FBUyxFQUFFLENBQUM7UUFDMUMsSUFBSSxDQUFDLGFBQWEsR0FBRyxFQUFFLENBQUM7UUFFeEIsK0VBQStFO1FBQy9FLElBQUksQ0FBQyx3QkFBd0IsR0FBRyxJQUFJLENBQUMsWUFBWSxDQUFDLFlBQVksQ0FBQyxTQUFTOzs7O1FBQUMsVUFBQyxNQUFzQjtZQUM5RixLQUFJLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUk7OztZQUFDO2dCQUM3QixLQUFJLENBQUMsWUFBWSxDQUFDLFFBQVEsRUFBRSxDQUFDO1lBQy9CLENBQUMsRUFBQyxDQUFDO1FBQ0wsQ0FBQyxFQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQ7O09BRUc7Ozs7O0lBQ0ksZ0RBQVc7Ozs7SUFB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QyxTQUFTLENBQUM7SUFDbEUsQ0FBQzs7Z0JBemNGLFNBQVMsU0FBQztvQkFDVCxlQUFlLEVBQUUsdUJBQXVCLENBQUMsTUFBTTs7b0JBQy9DLElBQUksRUFBRTt3QkFDSixLQUFLLEVBQUUscUJBQXFCO3FCQUM3QjtvQkFDRCxRQUFRLEVBQUUsb0JBQW9CO29CQUM5Qix3VUFBa0Q7aUJBQ25EOzs7O2dCQTlCaUMsaUJBQWlCO2dCQU8xQyxvQkFBb0I7Z0JBRHBCLGVBQWU7O0lBMmR4QixpQ0FBQztDQUFBLEFBMWNELElBMGNDO1NBbGNZLDBCQUEwQjs7Ozs7O0lBSXJDLG1EQUFrRDs7Ozs7O0lBS2xELG9EQUFtRDs7Ozs7O0lBS25ELGtEQUFvRDs7Ozs7O0lBS3BELDRDQUF3Qzs7Ozs7O0lBS3hDLDhEQUErQzs7Ozs7O0lBSy9DLHlEQUF3QyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENoYW5nZURldGVjdGlvblN0cmF0ZWd5LCBDaGFuZ2VEZXRlY3RvclJlZiwgQ29tcG9uZW50LCBPbkRlc3Ryb3kgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFN1YnNjcmlwdGlvbiB9IGZyb20gJ3J4anMnO1xuXG5pbXBvcnQgeyBOb3RpZmllckFjdGlvbiB9IGZyb20gJy4uL21vZGVscy9ub3RpZmllci1hY3Rpb24ubW9kZWwnO1xuaW1wb3J0IHsgTm90aWZpZXJDb25maWcgfSBmcm9tICcuLi9tb2RlbHMvbm90aWZpZXItY29uZmlnLm1vZGVsJztcbmltcG9ydCB7IE5vdGlmaWVyTm90aWZpY2F0aW9uIH0gZnJvbSAnLi4vbW9kZWxzL25vdGlmaWVyLW5vdGlmaWNhdGlvbi5tb2RlbCc7XG5pbXBvcnQgeyBOb3RpZmllclNlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy9ub3RpZmllci5zZXJ2aWNlJztcbmltcG9ydCB7IE5vdGlmaWVyUXVldWVTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvbm90aWZpZXItcXVldWUuc2VydmljZSc7XG5pbXBvcnQgeyBOb3RpZmllck5vdGlmaWNhdGlvbkNvbXBvbmVudCB9IGZyb20gJy4vbm90aWZpZXItbm90aWZpY2F0aW9uLmNvbXBvbmVudCc7XG5cbi8qKlxuICogTm90aWZpZXIgY29udGFpbmVyIGNvbXBvbmVudFxuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogVGhpcyBjb21wb25lbnQgYWN0cyBhcyBhIHdyYXBwZXIgZm9yIGFsbCBub3RpZmljYXRpb24gY29tcG9uZW50czsgY29uc2VxdWVudGx5LCBpdCBpcyByZXNwb25zaWJsZSBmb3IgY3JlYXRpbmcgYSBuZXcgbm90aWZpY2F0aW9uXG4gKiBjb21wb25lbnQgYW5kIHJlbW92aW5nIGFuIGV4aXN0aW5nIG5vdGlmaWNhdGlvbiBjb21wb25lbnQuIEJlaW5nIG1vcmUgcHJlY2ljZWx5LCBpdCBhbHNvIGhhbmRsZXMgc2lkZSBlZmZlY3RzIG9mIHRob3NlIGFjdGlvbnMsIHN1Y2ggYXNcbiAqIHNoaWZ0aW5nIG9yIGV2ZW4gY29tcGxldGVseSByZW1vdmluZyBvdGhlciBub3RpZmljYXRpb25zIGFzIHdlbGwuIE92ZXJhbGwsIHRoaXMgY29tcG9uZW50cyBoYW5kbGVzIGFjdGlvbnMgY29taW5nIGZyb20gdGhlIHF1ZXVlIHNlcnZpY2VcbiAqIGJ5IHN1YnNjcmliaW5nIHRvIGl0cyBhY3Rpb24gc3RyZWFtLlxuICpcbiAqIFRlY2huaWNhbCBzaWRlbm90ZTpcbiAqIFRoaXMgY29tcG9uZW50IGhhcyB0byBiZSB1c2VkIHNvbWV3aGVyZSBpbiBhbiBhcHBsaWNhdGlvbiB0byB3b3JrOyBpdCB3aWxsIG5vdCBpbmplY3QgYW5kIGNyZWF0ZSBpdHNlbGYgYXV0b21hdGljYWxseSwgcHJpbWFyaWx5IGluIG9yZGVyXG4gKiB0byBub3QgYnJlYWsgdGhlIEFuZ3VsYXIgQW9UIGNvbXBpbGF0aW9uLiBNb3Jlb3ZlciwgdGhpcyBjb21wb25lbnQgKGFuZCBhbHNvIHRoZSBub3RpZmljYXRpb24gY29tcG9uZW50cykgc2V0IHRoZWlyIGNoYW5nZSBkZXRlY3Rpb25cbiAqIHN0cmF0ZWd5IG9uUHVzaCwgd2hpY2ggbWVhbnMgdGhhdCB3ZSBoYW5kbGUgY2hhbmdlIGRldGVjdGlvbiBtYW51YWxseSBpbiBvcmRlciB0byBnZXQgdGhlIGJlc3QgcGVyZm9ybWFuY2UuICgjcGVyZm1hdHRlcnMpXG4gKi9cbkBDb21wb25lbnQoe1xuICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCwgLy8gKCNwZXJmbWF0dGVycylcbiAgaG9zdDoge1xuICAgIGNsYXNzOiAnbm90aWZpZXJfX2NvbnRhaW5lcicsXG4gIH0sXG4gIHNlbGVjdG9yOiAnbm90aWZpZXItY29udGFpbmVyJyxcbiAgdGVtcGxhdGVVcmw6ICcuL25vdGlmaWVyLWNvbnRhaW5lci5jb21wb25lbnQuaHRtbCcsXG59KVxuZXhwb3J0IGNsYXNzIE5vdGlmaWVyQ29udGFpbmVyQ29tcG9uZW50IGltcGxlbWVudHMgT25EZXN0cm95IHtcbiAgLyoqXG4gICAqIExpc3Qgb2YgY3VycmVudGx5IHNvbWV3aGF0IGFjdGl2ZSBub3RpZmljYXRpb25zXG4gICAqL1xuICBwdWJsaWMgbm90aWZpY2F0aW9uczogQXJyYXk8Tm90aWZpZXJOb3RpZmljYXRpb24+O1xuXG4gIC8qKlxuICAgKiBDaGFuZ2UgZGV0ZWN0b3JcbiAgICovXG4gIHByaXZhdGUgcmVhZG9ubHkgY2hhbmdlRGV0ZWN0b3I6IENoYW5nZURldGVjdG9yUmVmO1xuXG4gIC8qKlxuICAgKiBOb3RpZmllciBxdWV1ZSBzZXJ2aWNlXG4gICAqL1xuICBwcml2YXRlIHJlYWRvbmx5IHF1ZXVlU2VydmljZTogTm90aWZpZXJRdWV1ZVNlcnZpY2U7XG5cbiAgLyoqXG4gICAqIE5vdGlmaWVyIGNvbmZpZ3VyYXRpb25cbiAgICovXG4gIHByaXZhdGUgcmVhZG9ubHkgY29uZmlnOiBOb3RpZmllckNvbmZpZztcblxuICAvKipcbiAgICogUXVldWUgc2VydmljZSBvYnNlcnZhYmxlIHN1YnNjcmlwdGlvbiAoc2F2ZWQgZm9yIGNsZWFudXApXG4gICAqL1xuICBwcml2YXRlIHF1ZXVlU2VydmljZVN1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uO1xuXG4gIC8qKlxuICAgKiBQcm9taXNlIHJlc29sdmUgZnVuY3Rpb24gcmVmZXJlbmNlLCB0ZW1wb3JhcmlseSB1c2VkIHdoaWxlIHRoZSBub3RpZmljYXRpb24gY2hpbGQgY29tcG9uZW50IGdldHMgY3JlYXRlZFxuICAgKi9cbiAgcHJpdmF0ZSB0ZW1wUHJvbWlzZVJlc29sdmVyOiAoKSA9PiB2b2lkO1xuXG4gIC8qKlxuICAgKiBDb25zdHJ1Y3RvclxuICAgKlxuICAgKiBAcGFyYW0gY2hhbmdlRGV0ZWN0b3IgICAgICAgQ2hhbmdlIGRldGVjdG9yLCB1c2VkIGZvciBtYW51YWxseSB0cmlnZ2VyaW5nIGNoYW5nZSBkZXRlY3Rpb24gcnVuc1xuICAgKiBAcGFyYW0gbm90aWZpZXJRdWV1ZVNlcnZpY2UgTm90aWZpZXIgcXVldWUgc2VydmljZVxuICAgKiBAcGFyYW0gbm90aWZpZXJTZXJ2aWNlICAgICAgTm90aWZpZXIgc2VydmljZVxuICAgKi9cbiAgcHVibGljIGNvbnN0cnVjdG9yKGNoYW5nZURldGVjdG9yOiBDaGFuZ2VEZXRlY3RvclJlZiwgbm90aWZpZXJRdWV1ZVNlcnZpY2U6IE5vdGlmaWVyUXVldWVTZXJ2aWNlLCBub3RpZmllclNlcnZpY2U6IE5vdGlmaWVyU2VydmljZSkge1xuICAgIHRoaXMuY2hhbmdlRGV0ZWN0b3IgPSBjaGFuZ2VEZXRlY3RvcjtcbiAgICB0aGlzLnF1ZXVlU2VydmljZSA9IG5vdGlmaWVyUXVldWVTZXJ2aWNlO1xuICAgIHRoaXMuY29uZmlnID0gbm90aWZpZXJTZXJ2aWNlLmdldENvbmZpZygpO1xuICAgIHRoaXMubm90aWZpY2F0aW9ucyA9IFtdO1xuXG4gICAgLy8gQ29ubmVjdHMgdGhpcyBjb21wb25lbnQgdXAgdG8gdGhlIGFjdGlvbiBxdWV1ZSwgdGhlbiBoYW5kbGUgaW5jb21pbmcgYWN0aW9uc1xuICAgIHRoaXMucXVldWVTZXJ2aWNlU3Vic2NyaXB0aW9uID0gdGhpcy5xdWV1ZVNlcnZpY2UuYWN0aW9uU3RyZWFtLnN1YnNjcmliZSgoYWN0aW9uOiBOb3RpZmllckFjdGlvbikgPT4ge1xuICAgICAgdGhpcy5oYW5kbGVBY3Rpb24oYWN0aW9uKS50aGVuKCgpID0+IHtcbiAgICAgICAgdGhpcy5xdWV1ZVNlcnZpY2UuY29udGludWUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbXBvbmVudCBkZXN0cm95bWVudCBsaWZlY3ljbGUgaG9vaywgY2xlYW5zIHVwIHRoZSBvYnNlcnZhYmxlIHN1YnNjaXB0aW9uXG4gICAqL1xuICBwdWJsaWMgbmdPbkRlc3Ryb3koKTogdm9pZCB7XG4gICAgaWYgKHRoaXMucXVldWVTZXJ2aWNlU3Vic2NyaXB0aW9uKSB7XG4gICAgICB0aGlzLnF1ZXVlU2VydmljZVN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBOb3RpZmljYXRpb24gaWRlbnRpZmllciwgdXNlZCBhcyB0aGUgbmdGb3IgdHJhY2tieSBmdW5jdGlvblxuICAgKlxuICAgKiBAcGFyYW0gICBpbmRleCAgICAgICAgSW5kZXhcbiAgICogQHBhcmFtICAgbm90aWZpY2F0aW9uIE5vdGlmaWVyIG5vdGlmaWNhdGlvblxuICAgKiBAcmV0dXJucyBOb3RpZmljYXRpb24gSUQgYXMgdGhlIHVuaXF1ZSBpZGVudG5maWVyXG4gICAqL1xuICBwdWJsaWMgaWRlbnRpZnlOb3RpZmljYXRpb24oaW5kZXg6IG51bWJlciwgbm90aWZpY2F0aW9uOiBOb3RpZmllck5vdGlmaWNhdGlvbik6IHN0cmluZyB7XG4gICAgcmV0dXJuIG5vdGlmaWNhdGlvbi5pZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBFdmVudCBoYW5kbGVyLCBoYW5kbGVzIGNsaWNrcyBvbiBub3RpZmljYXRpb24gZGlzbWlzcyBidXR0b25zXG4gICAqXG4gICAqIEBwYXJhbSBub3RpZmljYXRpb25JZCBJRCBvZiB0aGUgbm90aWZpY2F0aW9uIHRvIGRpc21pc3NcbiAgICovXG4gIHB1YmxpYyBvbk5vdGlmaWNhdGlvbkRpc21pc3Mobm90aWZpY2F0aW9uSWQ6IHN0cmluZyk6IHZvaWQge1xuICAgIHRoaXMucXVldWVTZXJ2aWNlLnB1c2goe1xuICAgICAgcGF5bG9hZDogbm90aWZpY2F0aW9uSWQsXG4gICAgICB0eXBlOiAnSElERScsXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogRXZlbnQgaGFuZGxlciwgaGFuZGxlcyBub3RpZmljYXRpb24gcmVhZHkgZXZlbnRzXG4gICAqXG4gICAqIEBwYXJhbSBub3RpZmljYXRpb25Db21wb25lbnQgTm90aWZpY2F0aW9uIGNvbXBvbmVudCByZWZlcmVuY2VcbiAgICovXG4gIHB1YmxpYyBvbk5vdGlmaWNhdGlvblJlYWR5KG5vdGlmaWNhdGlvbkNvbXBvbmVudDogTm90aWZpZXJOb3RpZmljYXRpb25Db21wb25lbnQpOiB2b2lkIHtcbiAgICBjb25zdCBjdXJyZW50Tm90aWZpY2F0aW9uOiBOb3RpZmllck5vdGlmaWNhdGlvbiA9IHRoaXMubm90aWZpY2F0aW9uc1t0aGlzLm5vdGlmaWNhdGlvbnMubGVuZ3RoIC0gMV07IC8vIEdldCB0aGUgbGF0ZXN0IG5vdGlmaWNhdGlvblxuICAgIGN1cnJlbnROb3RpZmljYXRpb24uY29tcG9uZW50ID0gbm90aWZpY2F0aW9uQ29tcG9uZW50OyAvLyBTYXZlIHRoZSBuZXcgb21wb25lbnQgcmVmZXJlbmNlXG4gICAgdGhpcy5jb250aW51ZUhhbmRsZVNob3dBY3Rpb24oY3VycmVudE5vdGlmaWNhdGlvbik7IC8vIENvbnRpbnVlIHdpdGggaGFuZGxpbmcgdGhlIHNob3cgYWN0aW9uXG4gIH1cblxuICAvKipcbiAgICogSGFuZGxlIGluY29taW5nIGFjdGlvbnMgYnkgbWFwcGluZyBhY3Rpb24gdHlwZXMgdG8gbWV0aG9kcywgYW5kIHRoZW4gcnVubmluZyB0aGVtXG4gICAqXG4gICAqIEBwYXJhbSAgIGFjdGlvbiBBY3Rpb24gb2JqZWN0XG4gICAqIEByZXR1cm5zIFByb21pc2UsIHJlc29sdmVkIHdoZW4gZG9uZVxuICAgKi9cbiAgcHJpdmF0ZSBoYW5kbGVBY3Rpb24oYWN0aW9uOiBOb3RpZmllckFjdGlvbik6IFByb21pc2U8dm9pZD4ge1xuICAgIHN3aXRjaCAoXG4gICAgICBhY3Rpb24udHlwZSAvLyBUT0RPOiBNYXliZSBhIG1hcCAoYWN0aW9uVHlwZSAtPiBjbGFzcyBtZXRob2QpIGlzIGEgY2xlYW5lciBzb2x1dGlvbiBoZXJlP1xuICAgICkge1xuICAgICAgY2FzZSAnU0hPVyc6XG4gICAgICAgIHJldHVybiB0aGlzLmhhbmRsZVNob3dBY3Rpb24oYWN0aW9uKTtcbiAgICAgIGNhc2UgJ0hJREUnOlxuICAgICAgICByZXR1cm4gdGhpcy5oYW5kbGVIaWRlQWN0aW9uKGFjdGlvbik7XG4gICAgICBjYXNlICdISURFX09MREVTVCc6XG4gICAgICAgIHJldHVybiB0aGlzLmhhbmRsZUhpZGVPbGRlc3RBY3Rpb24oYWN0aW9uKTtcbiAgICAgIGNhc2UgJ0hJREVfTkVXRVNUJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlSGlkZU5ld2VzdEFjdGlvbihhY3Rpb24pO1xuICAgICAgY2FzZSAnSElERV9BTEwnOlxuICAgICAgICByZXR1cm4gdGhpcy5oYW5kbGVIaWRlQWxsQWN0aW9uKCk7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2U8dm9pZD4oKHJlc29sdmU6ICgpID0+IHZvaWQpID0+IHtcbiAgICAgICAgICByZXNvbHZlKCk7IC8vIElnbm9yZSB1bmtub3duIGFjdGlvbiB0eXBlc1xuICAgICAgICB9KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2hvdyBhIG5ldyBub3RpZmljYXRpb25cbiAgICpcbiAgICogV2Ugc2ltcGx5IGFkZCB0aGUgbm90aWZpY2F0aW9uIHRvIHRoZSBsaXN0LCBhbmQgdGhlbiB3YWl0IHVudGlsIGl0cyBwcm9wZXJseSBpbml0aWFsaXplZCAvIGNyZWF0ZWQgLyByZW5kZXJlZC5cbiAgICpcbiAgICogQHBhcmFtICAgYWN0aW9uIEFjdGlvbiBvYmplY3RcbiAgICogQHJldHVybnMgUHJvbWlzZSwgcmVzb2x2ZWQgd2hlbiBkb25lXG4gICAqL1xuICBwcml2YXRlIGhhbmRsZVNob3dBY3Rpb24oYWN0aW9uOiBOb3RpZmllckFjdGlvbik6IFByb21pc2U8dm9pZD4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZTx2b2lkPigocmVzb2x2ZTogKCkgPT4gdm9pZCkgPT4ge1xuICAgICAgdGhpcy50ZW1wUHJvbWlzZVJlc29sdmVyID0gcmVzb2x2ZTsgLy8gU2F2ZSB0aGUgcHJvbWlzZSByZXNvbHZlIGZ1bmN0aW9uIHNvIHRoYXQgaXQgY2FuIGJlIGNhbGxlZCBsYXRlciBvbiBieSBhbm90aGVyIG1ldGhvZFxuICAgICAgdGhpcy5hZGROb3RpZmljYXRpb25Ub0xpc3QobmV3IE5vdGlmaWVyTm90aWZpY2F0aW9uKGFjdGlvbi5wYXlsb2FkKSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQ29udGludWUgdG8gc2hvdyBhIG5ldyBub3RpZmljYXRpb24gKGFmdGVyIHRoZSBub3RpZmljYXRpb24gY29tcG9uZW50cyBpcyBpbml0aWFsaXplZCAvIGNyZWF0ZWQgLyByZW5kZXJlZCkuXG4gICAqXG4gICAqIElmIHRoaXMgaXMgdGhlIGZpcnN0IChhbmQgdGh1cyBvbmx5KSBub3RpZmljYXRpb24sIHdlIGNhbiBzaW1wbHkgc2hvdyBpdC4gT3RoZXJ3aGlzZSwgaWYgc3RhY2tpbmcgaXMgZGlzYWJsZWQgKG9yIGEgbG93IHZhbHVlKSwgd2VcbiAgICogc3dpdGNoIG91dCBub3RpZmljYXRpb25zLCBpbiBwYXJ0aWN1bGFyIHdlIGhpZGUgdGhlIGV4aXN0aW5nIG9uZSwgYW5kIHRoZW4gc2hvdyBvdXIgbmV3IG9uZS4gWWV0LCBpZiBzdGFja2luZyBpcyBlbmFibGVkLCB3ZSBmaXJzdFxuICAgKiBzaGlmdCBhbGwgb2xkZXIgbm90aWZpY2F0aW9ucywgYW5kIHRoZW4gc2hvdyBvdXIgbmV3IG5vdGlmaWNhdGlvbi4gSW4gYWRkaXRpb24sIGlmIHRoZXJlIGFyZSB0b28gbWFueSBub3RpZmljYXRpb24gb24gdGhlIHNjcmVlbixcbiAgICogd2UgaGlkZSB0aGUgb2xkZXN0IG9uZSBmaXJzdC4gRnVydGhlcm1vcmUsIGlmIGNvbmZpZ3VyZWQsIGFuaW1hdGlvbiBvdmVybGFwcGluZyBpcyBhcHBsaWVkLlxuICAgKlxuICAgKiBAcGFyYW0gbm90aWZpY2F0aW9uIE5ldyBub3RpZmljYXRpb24gdG8gc2hvd1xuICAgKi9cbiAgcHJpdmF0ZSBjb250aW51ZUhhbmRsZVNob3dBY3Rpb24obm90aWZpY2F0aW9uOiBOb3RpZmllck5vdGlmaWNhdGlvbik6IHZvaWQge1xuICAgIC8vIEZpcnN0ICh3aGljaCBtZWFucyBvbmx5IG9uZSkgbm90aWZpY2F0aW9uIGluIHRoZSBsaXN0P1xuICAgIGNvbnN0IG51bWJlck9mTm90aWZpY2F0aW9uczogbnVtYmVyID0gdGhpcy5ub3RpZmljYXRpb25zLmxlbmd0aDtcbiAgICBpZiAobnVtYmVyT2ZOb3RpZmljYXRpb25zID09PSAxKSB7XG4gICAgICBub3RpZmljYXRpb24uY29tcG9uZW50LnNob3coKS50aGVuKHRoaXMudGVtcFByb21pc2VSZXNvbHZlcik7IC8vIERvbmVcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgaW1wbGljaXRTdGFja2luZ0xpbWl0ID0gMjtcblxuICAgICAgLy8gU3RhY2tpbmcgZW5hYmxlZD8gKHN0YWNraW5nIHZhbHVlIGJlbG93IDIgbWVhbnMgc3RhY2tpbmcgaXMgZGlzYWJsZWQpXG4gICAgICBpZiAodGhpcy5jb25maWcuYmVoYXZpb3VyLnN0YWNraW5nID09PSBmYWxzZSB8fCB0aGlzLmNvbmZpZy5iZWhhdmlvdXIuc3RhY2tpbmcgPCBpbXBsaWNpdFN0YWNraW5nTGltaXQpIHtcbiAgICAgICAgdGhpcy5ub3RpZmljYXRpb25zWzBdLmNvbXBvbmVudC5oaWRlKCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgdGhpcy5yZW1vdmVOb3RpZmljYXRpb25Gcm9tTGlzdCh0aGlzLm5vdGlmaWNhdGlvbnNbMF0pO1xuICAgICAgICAgIG5vdGlmaWNhdGlvbi5jb21wb25lbnQuc2hvdygpLnRoZW4odGhpcy50ZW1wUHJvbWlzZVJlc29sdmVyKTsgLy8gRG9uZVxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IHN0ZXBQcm9taXNlczogQXJyYXk8UHJvbWlzZTx2b2lkPj4gPSBbXTtcblxuICAgICAgICAvLyBBcmUgdGhlcmUgbm93IHRvbyBtYW55IG5vdGlmaWNhdGlvbnM/XG4gICAgICAgIGlmIChudW1iZXJPZk5vdGlmaWNhdGlvbnMgPiB0aGlzLmNvbmZpZy5iZWhhdmlvdXIuc3RhY2tpbmcpIHtcbiAgICAgICAgICBjb25zdCBvbGROb3RpZmljYXRpb25zOiBBcnJheTxOb3RpZmllck5vdGlmaWNhdGlvbj4gPSB0aGlzLm5vdGlmaWNhdGlvbnMuc2xpY2UoMSwgbnVtYmVyT2ZOb3RpZmljYXRpb25zIC0gMSk7XG5cbiAgICAgICAgICAvLyBBcmUgYW5pbWF0aW9ucyBlbmFibGVkP1xuICAgICAgICAgIGlmICh0aGlzLmNvbmZpZy5hbmltYXRpb25zLmVuYWJsZWQpIHtcbiAgICAgICAgICAgIC8vIElzIGFuaW1hdGlvbiBvdmVybGFwIGVuYWJsZWQ/XG4gICAgICAgICAgICBpZiAodGhpcy5jb25maWcuYW5pbWF0aW9ucy5vdmVybGFwICE9PSBmYWxzZSAmJiB0aGlzLmNvbmZpZy5hbmltYXRpb25zLm92ZXJsYXAgPiAwKSB7XG4gICAgICAgICAgICAgIHN0ZXBQcm9taXNlcy5wdXNoKHRoaXMubm90aWZpY2F0aW9uc1swXS5jb21wb25lbnQuaGlkZSgpKTtcbiAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgc3RlcFByb21pc2VzLnB1c2godGhpcy5zaGlmdE5vdGlmaWNhdGlvbnMob2xkTm90aWZpY2F0aW9ucywgbm90aWZpY2F0aW9uLmNvbXBvbmVudC5nZXRIZWlnaHQoKSwgdHJ1ZSkpO1xuICAgICAgICAgICAgICB9LCB0aGlzLmNvbmZpZy5hbmltYXRpb25zLmhpZGUuc3BlZWQgLSB0aGlzLmNvbmZpZy5hbmltYXRpb25zLm92ZXJsYXApO1xuICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICBzdGVwUHJvbWlzZXMucHVzaChub3RpZmljYXRpb24uY29tcG9uZW50LnNob3coKSk7XG4gICAgICAgICAgICAgIH0sIHRoaXMuY29uZmlnLmFuaW1hdGlvbnMuaGlkZS5zcGVlZCArIHRoaXMuY29uZmlnLmFuaW1hdGlvbnMuc2hpZnQuc3BlZWQgLSB0aGlzLmNvbmZpZy5hbmltYXRpb25zLm92ZXJsYXApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgc3RlcFByb21pc2VzLnB1c2goXG4gICAgICAgICAgICAgICAgbmV3IFByb21pc2U8dm9pZD4oKHJlc29sdmU6ICgpID0+IHZvaWQpID0+IHtcbiAgICAgICAgICAgICAgICAgIHRoaXMubm90aWZpY2F0aW9uc1swXS5jb21wb25lbnQuaGlkZSgpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNoaWZ0Tm90aWZpY2F0aW9ucyhvbGROb3RpZmljYXRpb25zLCBub3RpZmljYXRpb24uY29tcG9uZW50LmdldEhlaWdodCgpLCB0cnVlKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb24uY29tcG9uZW50LnNob3coKS50aGVuKHJlc29sdmUpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdGVwUHJvbWlzZXMucHVzaCh0aGlzLm5vdGlmaWNhdGlvbnNbMF0uY29tcG9uZW50LmhpZGUoKSk7XG4gICAgICAgICAgICBzdGVwUHJvbWlzZXMucHVzaCh0aGlzLnNoaWZ0Tm90aWZpY2F0aW9ucyhvbGROb3RpZmljYXRpb25zLCBub3RpZmljYXRpb24uY29tcG9uZW50LmdldEhlaWdodCgpLCB0cnVlKSk7XG4gICAgICAgICAgICBzdGVwUHJvbWlzZXMucHVzaChub3RpZmljYXRpb24uY29tcG9uZW50LnNob3coKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnN0IG9sZE5vdGlmaWNhdGlvbnM6IEFycmF5PE5vdGlmaWVyTm90aWZpY2F0aW9uPiA9IHRoaXMubm90aWZpY2F0aW9ucy5zbGljZSgwLCBudW1iZXJPZk5vdGlmaWNhdGlvbnMgLSAxKTtcblxuICAgICAgICAgIC8vIEFyZSBhbmltYXRpb25zIGVuYWJsZWQ/XG4gICAgICAgICAgaWYgKHRoaXMuY29uZmlnLmFuaW1hdGlvbnMuZW5hYmxlZCkge1xuICAgICAgICAgICAgLy8gSXMgYW5pbWF0aW9uIG92ZXJsYXAgZW5hYmxlZD9cbiAgICAgICAgICAgIGlmICh0aGlzLmNvbmZpZy5hbmltYXRpb25zLm92ZXJsYXAgIT09IGZhbHNlICYmIHRoaXMuY29uZmlnLmFuaW1hdGlvbnMub3ZlcmxhcCA+IDApIHtcbiAgICAgICAgICAgICAgc3RlcFByb21pc2VzLnB1c2godGhpcy5zaGlmdE5vdGlmaWNhdGlvbnMob2xkTm90aWZpY2F0aW9ucywgbm90aWZpY2F0aW9uLmNvbXBvbmVudC5nZXRIZWlnaHQoKSwgdHJ1ZSkpO1xuICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICBzdGVwUHJvbWlzZXMucHVzaChub3RpZmljYXRpb24uY29tcG9uZW50LnNob3coKSk7XG4gICAgICAgICAgICAgIH0sIHRoaXMuY29uZmlnLmFuaW1hdGlvbnMuc2hpZnQuc3BlZWQgLSB0aGlzLmNvbmZpZy5hbmltYXRpb25zLm92ZXJsYXApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgc3RlcFByb21pc2VzLnB1c2goXG4gICAgICAgICAgICAgICAgbmV3IFByb21pc2U8dm9pZD4oKHJlc29sdmU6ICgpID0+IHZvaWQpID0+IHtcbiAgICAgICAgICAgICAgICAgIHRoaXMuc2hpZnROb3RpZmljYXRpb25zKG9sZE5vdGlmaWNhdGlvbnMsIG5vdGlmaWNhdGlvbi5jb21wb25lbnQuZ2V0SGVpZ2h0KCksIHRydWUpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb24uY29tcG9uZW50LnNob3coKS50aGVuKHJlc29sdmUpO1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN0ZXBQcm9taXNlcy5wdXNoKHRoaXMuc2hpZnROb3RpZmljYXRpb25zKG9sZE5vdGlmaWNhdGlvbnMsIG5vdGlmaWNhdGlvbi5jb21wb25lbnQuZ2V0SGVpZ2h0KCksIHRydWUpKTtcbiAgICAgICAgICAgIHN0ZXBQcm9taXNlcy5wdXNoKG5vdGlmaWNhdGlvbi5jb21wb25lbnQuc2hvdygpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBQcm9taXNlLmFsbChzdGVwUHJvbWlzZXMpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgIGlmIChudW1iZXJPZk5vdGlmaWNhdGlvbnMgPiB0aGlzLmNvbmZpZy5iZWhhdmlvdXIuc3RhY2tpbmcpIHtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlTm90aWZpY2F0aW9uRnJvbUxpc3QodGhpcy5ub3RpZmljYXRpb25zWzBdKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy50ZW1wUHJvbWlzZVJlc29sdmVyKCk7XG4gICAgICAgIH0pOyAvLyBEb25lXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEhpZGUgYW4gZXhpc3Rpbmcgbm90aWZpY2F0aW9uXG4gICAqXG4gICAqIEZpc3QsIHdlIHNraXAgZXZlcnl0aGluZyBpZiB0aGVyZSBhcmUgbm8gbm90aWZpY2F0aW9ucyBhdCBhbGwsIG9yIHRoZSBnaXZlbiBub3RpZmljYXRpb24gZG9lcyBub3QgZXhpc3QuIFRoZW4sIHdlIGhpZGUgdGhlIGdpdmVuXG4gICAqIG5vdGlmaWNhdGlvbi4gSWYgdGhlcmUgZXhpc3Qgb2xkZXIgbm90aWZpY2F0aW9ucywgd2UgdGhlbiBzaGlmdCB0aGVtIGFyb3VuZCB0byBmaWxsIHRoZSBnYXAuIE9uY2UgYm90aCBoaWRpbmcgdGhlIGdpdmVuIG5vdGlmaWNhdGlvblxuICAgKiBhbmQgc2hpZnRpbmcgdGhlIG9sZGVyIG5vdGlmaWNhaXRvbnMgaXMgZG9uZSwgdGhlIGdpdmVuIG5vdGlmaWNhdGlvbiBnZXRzIGZpbmFsbHkgcmVtb3ZlZCAoZnJvbSB0aGUgRE9NKS5cbiAgICpcbiAgICogQHBhcmFtICAgYWN0aW9uIEFjdGlvbiBvYmplY3QsIHBheWxvYWQgY29udGFpbnMgdGhlIG5vdGlmaWNhdGlvbiBJRFxuICAgKiBAcmV0dXJucyBQcm9taXNlLCByZXNvbHZlZCB3aGVuIGRvbmVcbiAgICovXG4gIHByaXZhdGUgaGFuZGxlSGlkZUFjdGlvbihhY3Rpb246IE5vdGlmaWVyQWN0aW9uKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPHZvaWQ+KChyZXNvbHZlOiAoKSA9PiB2b2lkKSA9PiB7XG4gICAgICBjb25zdCBzdGVwUHJvbWlzZXM6IEFycmF5PFByb21pc2U8dm9pZD4+ID0gW107XG5cbiAgICAgIC8vIERvZXMgdGhlIG5vdGlmaWNhdGlvbiBleGlzdCAvIGFyZSB0aGVyZSBldmVuIGFueSBub3RpZmljYXRpb25zPyAobGV0J3MgcHJldmVudCBhY2NpZGVudGlhbCBlcnJvcnMpXG4gICAgICBjb25zdCBub3RpZmljYXRpb246IE5vdGlmaWVyTm90aWZpY2F0aW9uIHwgdW5kZWZpbmVkID0gdGhpcy5maW5kTm90aWZpY2F0aW9uQnlJZChhY3Rpb24ucGF5bG9hZCk7XG4gICAgICBpZiAobm90aWZpY2F0aW9uID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIEdldCBvbGRlciBub3RpZmljYXRpb25zXG4gICAgICBjb25zdCBub3RpZmljYXRpb25JbmRleDogbnVtYmVyIHwgdW5kZWZpbmVkID0gdGhpcy5maW5kTm90aWZpY2F0aW9uSW5kZXhCeUlkKGFjdGlvbi5wYXlsb2FkKTtcbiAgICAgIGlmIChub3RpZmljYXRpb25JbmRleCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY29uc3Qgb2xkTm90aWZpY2F0aW9uczogQXJyYXk8Tm90aWZpZXJOb3RpZmljYXRpb24+ID0gdGhpcy5ub3RpZmljYXRpb25zLnNsaWNlKDAsIG5vdGlmaWNhdGlvbkluZGV4KTtcblxuICAgICAgLy8gRG8gb2xkZXIgbm90aWZpY2F0aW9ucyBleGlzdCwgYW5kIHRodXMgZG8gd2UgbmVlZCB0byBzaGlmdCBvdGhlciBub3RpZmljYXRpb25zIGFzIGEgY29uc2VxdWVuY2U/XG4gICAgICBpZiAob2xkTm90aWZpY2F0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgIC8vIEFyZSBhbmltYXRpb25zIGVuYWJsZWQ/XG4gICAgICAgIGlmICh0aGlzLmNvbmZpZy5hbmltYXRpb25zLmVuYWJsZWQgJiYgdGhpcy5jb25maWcuYW5pbWF0aW9ucy5oaWRlLnNwZWVkID4gMCkge1xuICAgICAgICAgIC8vIElzIGFuaW1hdGlvbiBvdmVybGFwIGVuYWJsZWQ/XG4gICAgICAgICAgaWYgKHRoaXMuY29uZmlnLmFuaW1hdGlvbnMub3ZlcmxhcCAhPT0gZmFsc2UgJiYgdGhpcy5jb25maWcuYW5pbWF0aW9ucy5vdmVybGFwID4gMCkge1xuICAgICAgICAgICAgc3RlcFByb21pc2VzLnB1c2gobm90aWZpY2F0aW9uLmNvbXBvbmVudC5oaWRlKCkpO1xuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgIHN0ZXBQcm9taXNlcy5wdXNoKHRoaXMuc2hpZnROb3RpZmljYXRpb25zKG9sZE5vdGlmaWNhdGlvbnMsIG5vdGlmaWNhdGlvbi5jb21wb25lbnQuZ2V0SGVpZ2h0KCksIGZhbHNlKSk7XG4gICAgICAgICAgICB9LCB0aGlzLmNvbmZpZy5hbmltYXRpb25zLmhpZGUuc3BlZWQgLSB0aGlzLmNvbmZpZy5hbmltYXRpb25zLm92ZXJsYXApO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBub3RpZmljYXRpb24uY29tcG9uZW50LmhpZGUoKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgc3RlcFByb21pc2VzLnB1c2godGhpcy5zaGlmdE5vdGlmaWNhdGlvbnMob2xkTm90aWZpY2F0aW9ucywgbm90aWZpY2F0aW9uLmNvbXBvbmVudC5nZXRIZWlnaHQoKSwgZmFsc2UpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzdGVwUHJvbWlzZXMucHVzaChub3RpZmljYXRpb24uY29tcG9uZW50LmhpZGUoKSk7XG4gICAgICAgICAgc3RlcFByb21pc2VzLnB1c2godGhpcy5zaGlmdE5vdGlmaWNhdGlvbnMob2xkTm90aWZpY2F0aW9ucywgbm90aWZpY2F0aW9uLmNvbXBvbmVudC5nZXRIZWlnaHQoKSwgZmFsc2UpKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3RlcFByb21pc2VzLnB1c2gobm90aWZpY2F0aW9uLmNvbXBvbmVudC5oaWRlKCkpO1xuICAgICAgfVxuXG4gICAgICAvLyBXYWl0IHVudGlsIGJvdGggaGlkaW5nIGFuZCBzaGlmdGluZyBpcyBkb25lLCB0aGVuIHJlbW92ZSB0aGUgbm90aWZpY2F0aW9uIGZyb20gdGhlIGxpc3RcbiAgICAgIFByb21pc2UuYWxsKHN0ZXBQcm9taXNlcykudGhlbigoKSA9PiB7XG4gICAgICAgIHRoaXMucmVtb3ZlTm90aWZpY2F0aW9uRnJvbUxpc3Qobm90aWZpY2F0aW9uKTtcbiAgICAgICAgcmVzb2x2ZSgpOyAvLyBEb25lXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIaWRlIHRoZSBvbGRlc3Qgbm90aWZpY2F0aW9uIChicmlkZ2UgdG8gaGFuZGxlSGlkZUFjdGlvbilcbiAgICpcbiAgICogQHBhcmFtICAgYWN0aW9uIEFjdGlvbiBvYmplY3RcbiAgICogQHJldHVybnMgUHJvbWlzZSwgcmVzb2x2ZWQgd2hlbiBkb25lXG4gICAqL1xuICBwcml2YXRlIGhhbmRsZUhpZGVPbGRlc3RBY3Rpb24oYWN0aW9uOiBOb3RpZmllckFjdGlvbik6IFByb21pc2U8dm9pZD4ge1xuICAgIC8vIEFyZSB0aGVyZSBhbnkgbm90aWZpY2F0aW9ucz8gKHByZXZlbnQgYWNjaWRlbnRpYWwgZXJyb3JzKVxuICAgIGlmICh0aGlzLm5vdGlmaWNhdGlvbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gbmV3IFByb21pc2U8dm9pZD4oKHJlc29sdmU6ICgpID0+IHZvaWQpID0+IHtcbiAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgfSk7IC8vIERvbmVcbiAgICB9IGVsc2Uge1xuICAgICAgYWN0aW9uLnBheWxvYWQgPSB0aGlzLm5vdGlmaWNhdGlvbnNbMF0uaWQ7XG4gICAgICByZXR1cm4gdGhpcy5oYW5kbGVIaWRlQWN0aW9uKGFjdGlvbik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEhpZGUgdGhlIG5ld2VzdCBub3RpZmljYXRpb24gKGJyaWRnZSB0byBoYW5kbGVIaWRlQWN0aW9uKVxuICAgKlxuICAgKiBAcGFyYW0gICBhY3Rpb24gQWN0aW9uIG9iamVjdFxuICAgKiBAcmV0dXJucyBQcm9taXNlLCByZXNvbHZlZCB3aGVuIGRvbmVcbiAgICovXG4gIHByaXZhdGUgaGFuZGxlSGlkZU5ld2VzdEFjdGlvbihhY3Rpb246IE5vdGlmaWVyQWN0aW9uKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgLy8gQXJlIHRoZXJlIGFueSBub3RpZmljYXRpb25zPyAocHJldmVudCBhY2NpZGVudGlhbCBlcnJvcnMpXG4gICAgaWYgKHRoaXMubm90aWZpY2F0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiBuZXcgUHJvbWlzZTx2b2lkPigocmVzb2x2ZTogKCkgPT4gdm9pZCkgPT4ge1xuICAgICAgICByZXNvbHZlKCk7XG4gICAgICB9KTsgLy8gRG9uZVxuICAgIH0gZWxzZSB7XG4gICAgICBhY3Rpb24ucGF5bG9hZCA9IHRoaXMubm90aWZpY2F0aW9uc1t0aGlzLm5vdGlmaWNhdGlvbnMubGVuZ3RoIC0gMV0uaWQ7XG4gICAgICByZXR1cm4gdGhpcy5oYW5kbGVIaWRlQWN0aW9uKGFjdGlvbik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEhpZGUgYWxsIG5vdGlmaWNhdGlvbnMgYXQgb25jZVxuICAgKlxuICAgKiBAcmV0dXJucyBQcm9taXNlLCByZXNvbHZlZCB3aGVuIGRvbmVcbiAgICovXG4gIHByaXZhdGUgaGFuZGxlSGlkZUFsbEFjdGlvbigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICByZXR1cm4gbmV3IFByb21pc2U8dm9pZD4oKHJlc29sdmU6ICgpID0+IHZvaWQpID0+IHtcbiAgICAgIC8vIEFyZSB0aGVyZSBhbnkgbm90aWZpY2F0aW9ucz8gKHByZXZlbnQgYWNjaWRlbnRpYWwgZXJyb3JzKVxuICAgICAgY29uc3QgbnVtYmVyT2ZOb3RpZmljYXRpb25zOiBudW1iZXIgPSB0aGlzLm5vdGlmaWNhdGlvbnMubGVuZ3RoO1xuICAgICAgaWYgKG51bWJlck9mTm90aWZpY2F0aW9ucyA9PT0gMCkge1xuICAgICAgICByZXNvbHZlKCk7IC8vIERvbmVcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBBcmUgYW5pbWF0aW9ucyBlbmFibGVkP1xuICAgICAgaWYgKFxuICAgICAgICB0aGlzLmNvbmZpZy5hbmltYXRpb25zLmVuYWJsZWQgJiZcbiAgICAgICAgdGhpcy5jb25maWcuYW5pbWF0aW9ucy5oaWRlLnNwZWVkID4gMCAmJlxuICAgICAgICB0aGlzLmNvbmZpZy5hbmltYXRpb25zLmhpZGUub2Zmc2V0ICE9PSBmYWxzZSAmJlxuICAgICAgICB0aGlzLmNvbmZpZy5hbmltYXRpb25zLmhpZGUub2Zmc2V0ID4gMFxuICAgICAgKSB7XG4gICAgICAgIGZvciAobGV0IGk6IG51bWJlciA9IG51bWJlck9mTm90aWZpY2F0aW9ucyAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgY29uc3QgYW5pbWF0aW9uT2Zmc2V0OiBudW1iZXIgPSB0aGlzLmNvbmZpZy5wb3NpdGlvbi52ZXJ0aWNhbC5wb3NpdGlvbiA9PT0gJ3RvcCcgPyBudW1iZXJPZk5vdGlmaWNhdGlvbnMgLSAxIDogaTtcbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMubm90aWZpY2F0aW9uc1tpXS5jb21wb25lbnQuaGlkZSgpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAvLyBBcmUgd2UgZG9uZSBoZXJlLCB3YXMgdGhpcyB0aGUgbGFzdCBub3RpZmljYXRpb24gdG8gYmUgaGlkZGVuP1xuICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgKHRoaXMuY29uZmlnLnBvc2l0aW9uLnZlcnRpY2FsLnBvc2l0aW9uID09PSAndG9wJyAmJiBpID09PSAwKSB8fFxuICAgICAgICAgICAgICAgICh0aGlzLmNvbmZpZy5wb3NpdGlvbi52ZXJ0aWNhbC5wb3NpdGlvbiA9PT0gJ2JvdHRvbScgJiYgaSA9PT0gbnVtYmVyT2ZOb3RpZmljYXRpb25zIC0gMSlcbiAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVBbGxOb3RpZmljYXRpb25zRnJvbUxpc3QoKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKCk7IC8vIERvbmVcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSwgdGhpcy5jb25maWcuYW5pbWF0aW9ucy5oaWRlLm9mZnNldCAqIGFuaW1hdGlvbk9mZnNldCk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IHN0ZXBQcm9taXNlczogQXJyYXk8UHJvbWlzZTx2b2lkPj4gPSBbXTtcbiAgICAgICAgZm9yIChsZXQgaTogbnVtYmVyID0gbnVtYmVyT2ZOb3RpZmljYXRpb25zIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICBzdGVwUHJvbWlzZXMucHVzaCh0aGlzLm5vdGlmaWNhdGlvbnNbaV0uY29tcG9uZW50LmhpZGUoKSk7XG4gICAgICAgIH1cbiAgICAgICAgUHJvbWlzZS5hbGwoc3RlcFByb21pc2VzKS50aGVuKCgpID0+IHtcbiAgICAgICAgICB0aGlzLnJlbW92ZUFsbE5vdGlmaWNhdGlvbnNGcm9tTGlzdCgpO1xuICAgICAgICAgIHJlc29sdmUoKTsgLy8gRG9uZVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTaGlmdCBtdWx0aXBsZSBub3RpZmljYXRpb25zIGF0IG9uY2VcbiAgICpcbiAgICogQHBhcmFtICAgbm90aWZpY2F0aW9ucyBMaXN0IGNvbnRhaW5pbmcgdGhlIG5vdGlmaWNhdGlvbnMgdG8gYmUgc2hpZnRlZFxuICAgKiBAcGFyYW0gICBkaXN0YW5jZSAgICAgIERpc3RhbmNlIHRvIHNoaWZ0IChpbiBweClcbiAgICogQHBhcmFtICAgdG9NYWtlUGxhY2UgICBGbGFnLCBkZWZpbmluZyBpbiB3aGljaCBkaXJlY2l0b24gdG8gc2hpZnRcbiAgICogQHJldHVybnMgUHJvbWlzZSwgcmVzb2x2ZWQgd2hlbiBkb25lXG4gICAqL1xuICBwcml2YXRlIHNoaWZ0Tm90aWZpY2F0aW9ucyhub3RpZmljYXRpb25zOiBBcnJheTxOb3RpZmllck5vdGlmaWNhdGlvbj4sIGRpc3RhbmNlOiBudW1iZXIsIHRvTWFrZVBsYWNlOiBib29sZWFuKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPHZvaWQ+KChyZXNvbHZlOiAoKSA9PiB2b2lkKSA9PiB7XG4gICAgICAvLyBBcmUgdGhlcmUgYW55IG5vdGlmaWNhdGlvbnMgdG8gc2hpZnQ/XG4gICAgICBpZiAobm90aWZpY2F0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IG5vdGlmaWNhdGlvblByb21pc2VzOiBBcnJheTxQcm9taXNlPHZvaWQ+PiA9IFtdO1xuICAgICAgZm9yIChsZXQgaTogbnVtYmVyID0gbm90aWZpY2F0aW9ucy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICBub3RpZmljYXRpb25Qcm9taXNlcy5wdXNoKG5vdGlmaWNhdGlvbnNbaV0uY29tcG9uZW50LnNoaWZ0KGRpc3RhbmNlLCB0b01ha2VQbGFjZSkpO1xuICAgICAgfVxuICAgICAgUHJvbWlzZS5hbGwobm90aWZpY2F0aW9uUHJvbWlzZXMpLnRoZW4ocmVzb2x2ZSk7IC8vIERvbmVcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgYSBuZXcgbm90aWZpY2F0aW9uIHRvIHRoZSBsaXN0IG9mIG5vdGlmaWNhdGlvbnMgKHRyaWdnZXJzIGNoYW5nZSBkZXRlY3Rpb24pXG4gICAqXG4gICAqIEBwYXJhbSBub3RpZmljYXRpb24gTm90aWZpY2F0aW9uIHRvIGFkZCB0byB0aGUgbGlzdCBvZiBub3RpZmljYXRpb25zXG4gICAqL1xuICBwcml2YXRlIGFkZE5vdGlmaWNhdGlvblRvTGlzdChub3RpZmljYXRpb246IE5vdGlmaWVyTm90aWZpY2F0aW9uKTogdm9pZCB7XG4gICAgdGhpcy5ub3RpZmljYXRpb25zLnB1c2gobm90aWZpY2F0aW9uKTtcbiAgICB0aGlzLmNoYW5nZURldGVjdG9yLm1hcmtGb3JDaGVjaygpOyAvLyBSdW4gY2hhbmdlIGRldGVjdGlvbiBiZWNhdXNlIHRoZSBub3RpZmljYXRpb24gbGlzdCBjaGFuZ2VkXG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlIGFuIGV4aXN0aW5nIG5vdGlmaWNhdGlvbiBmcm9tIHRoZSBsaXN0IG9mIG5vdGlmaWNhdGlvbnMgKHRyaWdnZXJzIGNoYW5nZSBkZXRlY3Rpb24pXG4gICAqXG4gICAqIEBwYXJhbSBub3RpZmljYXRpb24gTm90aWZpY2F0aW9uIHRvIGJlIHJlbW92ZWQgZnJvbSB0aGUgbGlzdCBvZiBub3RpZmljYXRpb25zXG4gICAqL1xuICBwcml2YXRlIHJlbW92ZU5vdGlmaWNhdGlvbkZyb21MaXN0KG5vdGlmaWNhdGlvbjogTm90aWZpZXJOb3RpZmljYXRpb24pOiB2b2lkIHtcbiAgICB0aGlzLm5vdGlmaWNhdGlvbnMgPSB0aGlzLm5vdGlmaWNhdGlvbnMuZmlsdGVyKChpdGVtOiBOb3RpZmllck5vdGlmaWNhdGlvbikgPT4gaXRlbS5jb21wb25lbnQgIT09IG5vdGlmaWNhdGlvbi5jb21wb25lbnQpO1xuICAgIHRoaXMuY2hhbmdlRGV0ZWN0b3IubWFya0ZvckNoZWNrKCk7IC8vIFJ1biBjaGFuZ2UgZGV0ZWN0aW9uIGJlY2F1c2UgdGhlIG5vdGlmaWNhdGlvbiBsaXN0IGNoYW5nZWRcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmUgYWxsIG5vdGlmaWNhdGlvbnMgZnJvbSB0aGUgbGlzdCAodHJpZ2dlcnMgY2hhbmdlIGRldGVjdGlvbilcbiAgICovXG4gIHByaXZhdGUgcmVtb3ZlQWxsTm90aWZpY2F0aW9uc0Zyb21MaXN0KCk6IHZvaWQge1xuICAgIHRoaXMubm90aWZpY2F0aW9ucyA9IFtdO1xuICAgIHRoaXMuY2hhbmdlRGV0ZWN0b3IubWFya0ZvckNoZWNrKCk7IC8vIFJ1biBjaGFuZ2UgZGV0ZWN0aW9uIGJlY2F1c2UgdGhlIG5vdGlmaWNhdGlvbiBsaXN0IGNoYW5nZWRcbiAgfVxuXG4gIC8qKlxuICAgKiBIZWxwZXI6IEZpbmQgYSBub3RpZmljYXRpb24gaW4gdGhlIG5vdGlmaWNhdGlvbiBsaXN0IGJ5IGEgZ2l2ZW4gbm90aWZpY2F0aW9uIElEXG4gICAqXG4gICAqIEBwYXJhbSAgIG5vdGlmaWNhdGlvbklkIE5vdGlmaWNhdGlvbiBJRCwgdXNlZCBmb3IgZmluZGluZyBub3RpZmljYXRpb25cbiAgICogQHJldHVybnMgTm90aWZpY2F0aW9uLCB1bmRlZmluZWQgaWYgbm90IGZvdW5kXG4gICAqL1xuICBwcml2YXRlIGZpbmROb3RpZmljYXRpb25CeUlkKG5vdGlmaWNhdGlvbklkOiBzdHJpbmcpOiBOb3RpZmllck5vdGlmaWNhdGlvbiB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMubm90aWZpY2F0aW9ucy5maW5kKChjdXJyZW50Tm90aWZpY2F0aW9uOiBOb3RpZmllck5vdGlmaWNhdGlvbikgPT4gY3VycmVudE5vdGlmaWNhdGlvbi5pZCA9PT0gbm90aWZpY2F0aW9uSWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIEhlbHBlcjogRmluZCBhIG5vdGlmaWNhdGlvbidzIGluZGV4IGJ5IGEgZ2l2ZW4gbm90aWZpY2F0aW9uIElEXG4gICAqXG4gICAqIEBwYXJhbSAgIG5vdGlmaWNhdGlvbklkIE5vdGlmaWNhdGlvbiBJRCwgdXNlZCBmb3IgZmluZGluZyBhIG5vdGlmaWNhdGlvbidzIGluZGV4XG4gICAqIEByZXR1cm5zIE5vdGlmaWNhdGlvbiBpbmRleCwgdW5kZWZpbmVkIGlmIG5vdCBmb3VuZFxuICAgKi9cbiAgcHJpdmF0ZSBmaW5kTm90aWZpY2F0aW9uSW5kZXhCeUlkKG5vdGlmaWNhdGlvbklkOiBzdHJpbmcpOiBudW1iZXIgfCB1bmRlZmluZWQge1xuICAgIGNvbnN0IG5vdGlmaWNhdGlvbkluZGV4OiBudW1iZXIgPSB0aGlzLm5vdGlmaWNhdGlvbnMuZmluZEluZGV4KFxuICAgICAgKGN1cnJlbnROb3RpZmljYXRpb246IE5vdGlmaWVyTm90aWZpY2F0aW9uKSA9PiBjdXJyZW50Tm90aWZpY2F0aW9uLmlkID09PSBub3RpZmljYXRpb25JZCxcbiAgICApO1xuICAgIHJldHVybiBub3RpZmljYXRpb25JbmRleCAhPT0gLTEgPyBub3RpZmljYXRpb25JbmRleCA6IHVuZGVmaW5lZDtcbiAgfVxufVxuIl19